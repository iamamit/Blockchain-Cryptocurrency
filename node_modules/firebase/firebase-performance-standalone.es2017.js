!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).firebase=e()}(this,function(){"use strict";function t(e,n){if(!(n instanceof Object))return n;switch(n.constructor){case Date:return new Date(n.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return n}for(const r in n)n.hasOwnProperty(r)&&(e[r]=t(e[r],n[r]));return e}const e="FirebaseError";class n extends Error{constructor(t,i){super(i),this.code=t,this.name=e,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,r.prototype.create)}}class r{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const r=e[0]||{},o=`${this.service}/${t}`,a=this.errors[t],s=a?function(t,e){return t.replace(i,(t,n)=>{const r=e[n];return null!=r?r.toString():`<${n}?>`})}(a,r):"Error",c=`${this.serviceName}: ${s} (${o}).`,u=new n(o,c);for(const t of Object.keys(r))"_"!==t.slice(-1)&&(t in u&&console.warn(`Overwriting FirebaseError base field "${t}" can cause unexpected behavior.`),u[t]=r[t]);return u}}const i=/\{\$([^}]+)}/g;function o(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const a=new r("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists","app-deleted":"Firebase App named '{$appName}' already deleted","duplicate-service":"Firebase service named '{$appName}' already registered","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),s="[DEFAULT]";class c{constructor(e,n,r){this.firebase_=r,this.isDeleted_=!1,this.services_={},this.INTERNAL={},this.name_=n.name,this.automaticDataCollectionEnabled_=n.automaticDataCollectionEnabled||!1,this.options_=t(void 0,e)}get automaticDataCollectionEnabled(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_}set automaticDataCollectionEnabled(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t}get name(){return this.checkDestroyed_(),this.name_}get options(){return this.checkDestroyed_(),this.options_}delete(){return new Promise(t=>{this.checkDestroyed_(),t()}).then(()=>{this.firebase_.INTERNAL.removeApp(this.name_);const t=[];for(const e of Object.keys(this.services_))for(const n of Object.keys(this.services_[e]))t.push(this.services_[e][n]);return Promise.all(t.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()))}).then(()=>{this.isDeleted_=!0,this.services_={}})}_getService(t,e=s){if(this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){const n=e!==s?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]}extendApp(e){t(this,e)}checkDestroyed_(){if(this.isDeleted_)throw a.create("app-deleted",{appName:this.name_})}}const u="6.4.0";const l=function(){const e=function(e){const n={},r={},i={},c={__esModule:!0,initializeApp:function(t,r={}){if("object"!=typeof r||null===r){const t=r;r={name:t}}const i=r;void 0===i.name&&(i.name=s);const{name:u}=i;if("string"!=typeof u||!u)throw a.create("bad-app-name",{appName:String(u)});if(o(n,u))throw a.create("duplicate-app",{appName:u});const l=new e(t,i,c);return n[u]=l,f(l,"create"),l},app:l,apps:null,SDK_VERSION:u,INTERNAL:{registerService:function(n,o,s,u,f=!1){if(r[n])throw a.create("duplicate-service",{appName:n});function d(t=l()){if("function"!=typeof t[n])throw a.create("invalid-app-argument",{appName:n});return t[n]()}return r[n]=o,u&&(i[n]=u,p().forEach(t=>{u("create",t)})),void 0!==s&&t(d,s),c[n]=d,e.prototype[n]=function(...t){return this._getService.bind(this,n).apply(this,f?t:[])},d},removeApp:function(t){f(n[t],"delete"),delete n[t]},factories:r,useAsService:d}};function l(t){if(!o(n,t=t||s))throw a.create("no-app",{appName:t});return n[t]}function p(){return Object.keys(n).map(t=>n[t])}function f(t,e){for(const n of Object.keys(r)){const r=d(0,n);if(null===r)return;i[r]&&i[r](e,t)}}function d(t,e){return"serverAuth"===e?null:e}return c.default=c,Object.defineProperty(c,"apps",{get:p}),l.App=e,c}(c);e.SDK_VERSION=`${e.SDK_VERSION}_LITE`;const n=e.INTERNAL.registerService;return e.INTERNAL.registerService=function(t,e,r,i,o){if("performance"!==t&&"installations"!==t)throw Error(`${t} cannot register with the standalone perf instance`);return n(t,e,r,i,o)},e}();function p(t){return Array.prototype.slice.call(t)}function f(t){return new Promise(function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function d(t,e,n){var r,i=new Promise(function(i,o){f(r=t[e].apply(t,n)).then(i,o)});return i.request=r,i}function h(t,e,n){var r=d(t,e,n);return r.then(function(t){if(t)return new w(t,r.request)})}function g(t,e,n){n.forEach(function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})})}function m(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return d(this[e],r,arguments)})})}function b(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})})}function _(t,e,n,r){r.forEach(function(r){r in n.prototype&&(t.prototype[r]=function(){return h(this[e],r,arguments)})})}function y(t){this._index=t}function w(t,e){this._cursor=t,this._request=e}function v(t){this._store=t}function E(t){this._tx=t,this.complete=new Promise(function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}})}function I(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new E(n)}function S(t){this._db=t}g(y,"_index",["name","keyPath","multiEntry","unique"]),m(y,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),_(y,"_index",IDBIndex,["openCursor","openKeyCursor"]),g(w,"_cursor",["direction","key","primaryKey","value"]),m(w,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(w.prototype[t]=function(){var e=this,n=arguments;return Promise.resolve().then(function(){return e._cursor[t].apply(e._cursor,n),f(e._request).then(function(t){if(t)return new w(t,e._request)})})})}),v.prototype.createIndex=function(){return new y(this._store.createIndex.apply(this._store,arguments))},v.prototype.index=function(){return new y(this._store.index.apply(this._store,arguments))},g(v,"_store",["name","keyPath","indexNames","autoIncrement"]),m(v,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),_(v,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),b(v,"_store",IDBObjectStore,["deleteIndex"]),E.prototype.objectStore=function(){return new v(this._tx.objectStore.apply(this._tx,arguments))},g(E,"_tx",["objectStoreNames","mode"]),b(E,"_tx",IDBTransaction,["abort"]),I.prototype.createObjectStore=function(){return new v(this._db.createObjectStore.apply(this._db,arguments))},g(I,"_db",["name","version","objectStoreNames"]),b(I,"_db",IDBDatabase,["deleteObjectStore","close"]),S.prototype.transaction=function(){return new E(this._db.transaction.apply(this._db,arguments))},g(S,"_db",["name","version","objectStoreNames"]),b(S,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(t){[v,y].forEach(function(e){t in e.prototype&&(e.prototype[t.replace("open","iterate")]=function(){var e=p(arguments),n=e[e.length-1],r=this._store||this._index,i=r[t].apply(r,e.slice(0,-1));i.onsuccess=function(){n(i.result)}})})}),[y,v].forEach(function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise(function(i){n.iterateCursor(t,function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)})})})});const T=1e4,A="w:0.2.4",N="FIS_v2",k="https://firebaseinstallations.googleapis.com/v1",O=36e5,D=new r("installations","Installations",{"missing-app-config-values":"Missing App configuration values.","create-installation-failed":"Could not register Firebase Installation.","generate-token-failed":"Could not generate Auth Token.","not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function R(t){return t instanceof n&&t.code.includes("request-failed")}function j(t){if(!t||!t.options)throw D.create("missing-app-config-values");const e=t.name,{projectId:n,apiKey:r,appId:i}=t.options;if(!(e&&n&&r&&i))throw D.create("missing-app-config-values");return{appName:e,projectId:n,apiKey:r,appId:i}}function P({projectId:t}){return`${k}/projects/${t}/installations`}function $(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function M(t,e){const n=(await e.json()).error;return D.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function C({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function L(t,{refreshToken:e}){const n=C(t);return n.append("Authorization",function(t){return`${N} ${t}`}(e)),n}async function B(t){const e=await t();return e.status>=500&&e.status<600?t():e}function q(t){return new Promise(e=>{setTimeout(e,t)})}const F=/^[cdef][\w-]{21}$/,U="";function x(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return F.test(e)?e:U}catch(t){return U}}const K="firebase-installations-database",V=1,H="firebase-installations-store";let W=null;function J(){return W||(W=function(t,e,n){var r=d(indexedDB,"open",[t,e]),i=r.request;return i&&(i.onupgradeneeded=function(t){n&&n(new I(i.result,t.oldVersion,i.transaction))}),r.then(function(t){return new S(t)})}(K,V,t=>{switch(t.oldVersion){case 0:t.createObjectStore(H)}})),W}async function z(t,e){const n=X(t),r=(await J()).transaction(H,"readwrite");return await r.objectStore(H).put(e,n),await r.complete,e}async function G(t){const e=X(t),n=(await J()).transaction(H,"readwrite");await n.objectStore(H).delete(e),await n.complete}async function Q(t,e){const n=X(t),r=(await J()).transaction(H,"readwrite"),i=r.objectStore(H),o=await i.get(n),a=e(o);return a===o?a:(void 0===a?await i.delete(n):await i.put(a,n),await r.complete,a)}function X(t){return`${t.appName}!${t.appId}`}async function Y(t){let e;const n=await Q(t,n=>{const r=function(t){const e=t||{fid:x(),registrationStatus:0};if(et(e))return{fid:e.fid,registrationStatus:0};return e}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine){const t=Promise.reject(D.create("app-offline"));return{installationEntry:e,registrationPromise:t}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(t,e){try{const n=await async function(t,{fid:e}){const n=P(t),r=C(t),i={fid:e,authVersion:N,appId:t.appId,sdkVersion:A},o={method:"POST",headers:r,body:JSON.stringify(i)},a=await B(()=>fetch(n,o));if(a.ok){const t=await a.json();return{fid:t.fid||e,registrationStatus:2,refreshToken:t.refreshToken,authToken:$(t.authToken)}}throw await M("Create Installation",a)}(t,e);return z(t,n)}catch(n){throw R(n)&&409===n.serverCode?await G(t):await z(t,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:r}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Z(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry});return n.fid===U?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function Z(t){let e=await tt(t);for(;1===e.registrationStatus;)await q(100),e=await tt(t);if(0===e.registrationStatus)throw D.create("create-installation-failed");return e}function tt(t){return Q(t,t=>{if(!t)throw D.create("installation-not-found");return et(t)?{fid:t.fid,registrationStatus:0}:t})}function et(t){return 1===t.registrationStatus&&t.registrationTime+T<Date.now()}async function nt(t,e){const n=function(t,{fid:e}){return`${P(t)}/${e}/authTokens:generate`}(t,e),r=L(t,e),i={installation:{sdkVersion:A}},o={method:"POST",headers:r,body:JSON.stringify(i)},a=await B(()=>fetch(n,o));if(a.ok){return $(await a.json())}throw await M("Generate Auth Token",a)}async function rt(t){let e;const n=await Q(t,n=>{if(!ot(n))throw D.create("not-registered");const r=n.authToken;if(function(t){return 2===t.requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+O}(t)}(r))return n;if(1===r.requestStatus)return e=async function(t){let e=await it(t);for(;1===e.authToken.requestStatus;)await q(100),e=await it(t);const n=e.authToken;if(0===n.requestStatus)throw D.create("generate-token-failed");return n}(t),n;{if(!navigator.onLine)throw D.create("app-offline");const r=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign({},t,{authToken:e})}(n);return e=async function(t,e){try{const n=await nt(t,e),r=Object.assign({},e,{authToken:n});return await z(t,r),n}catch(n){if(!R(n)||401!==n.serverCode&&404!==n.serverCode){const n=Object.assign({},e,{authToken:{requestStatus:0}});await z(t,n)}else await G(t);throw n}}(t,r),r}});return(e?await e:n.authToken).token}function it(t){return Q(t,t=>{if(!ot(t))throw D.create("not-registered");return function(t){return 1===t.requestStatus&&t.requestTime+T<Date.now()}(t.authToken)?Object.assign({},t,{authToken:{requestStatus:0}}):t})}function ot(t){return void 0!==t&&2===t.registrationStatus}async function at(t){const e=j(t);return await async function(t){const{installationEntry:e,registrationPromise:n}=await Y(t);if(n)await n;else if(2!==e.registrationStatus)throw D.create("create-installation-failed")}(e),rt(e)}async function st(t,e){const n=function(t,{fid:e}){return`${P(t)}/${e}`}(t,e),r={method:"DELETE",headers:L(t,e)},i=await B(()=>fetch(n,r));if(!i.ok)throw await M("Delete Installation",i)}var ct;l.INTERNAL.registerService("installations",t=>(j(t),{app:t,getId:()=>(async function(t){const e=j(t),{installationEntry:n,registrationPromise:r}=await Y(e);return r&&r.catch(()=>{}),2===n.registrationStatus&&rt(e).catch(()=>{}),n.fid})(t),getToken:()=>at(t),delete:()=>(async function(t){const e=j(t),n=await Q(e,t=>{if(!t||0!==t.registrationStatus)return t});if(n){if(1===n.registrationStatus)throw D.create("delete-pending-registration");if(2===n.registrationStatus){if(!navigator.onLine)throw D.create("app-offline");await st(e,n),await G(e)}}})(t)})),function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(ct||(ct={}));const ut=ct.INFO,lt=(t,e,...n)=>{if(e<t.logLevel)return;const r=(new Date).toISOString();switch(e){case ct.DEBUG:case ct.VERBOSE:console.log(`[${r}]  ${t.name}:`,...n);break;case ct.INFO:console.info(`[${r}]  ${t.name}:`,...n);break;case ct.WARN:console.warn(`[${r}]  ${t.name}:`,...n);break;case ct.ERROR:console.error(`[${r}]  ${t.name}:`,...n);break;default:throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)}};class pt{constructor(t){this.name=t,this._logLevel=ut,this._logHandler=lt}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in ct))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}debug(...t){this._logHandler(this,ct.DEBUG,...t)}log(...t){this._logHandler(this,ct.VERBOSE,...t)}info(...t){this._logHandler(this,ct.INFO,...t)}warn(...t){this._logHandler(this,ct.WARN,...t)}error(...t){this._logHandler(this,ct.ERROR,...t)}}const ft="0.2.15",dt="FB-PERF-TRACE-START",ht="FB-PERF-TRACE-STOP",gt="FB-PERF-TRACE-MEASURE",mt="_wt_",bt="_fp",_t="_fcp",yt="_fid",wt="@firebase/performance/config",vt="@firebase/performance/configexpire",Et=new r("performance","Performance",{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok"});let It,St,Tt,At;class Nt{constructor(t){if(!t)throw Et.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(t){this.performance&&this.performance.mark&&this.performance.mark(t)}measure(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)}getEntriesByType(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]}getEntriesByName(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!!(fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled)}setupObserver(t,e){if(!this.PerformanceObserver)return;new this.PerformanceObserver(t=>{for(const n of t.getEntries())e(n)}).observe({entryTypes:[t]})}static getInstance(){return void 0===It&&(It=new Nt(St)),It}}class kt{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getAppId(){const t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw Et.create("no app id");return t}getProjectId(){const t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw Et.create("no project id");return t}getApiKey(){const t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw Et.create("no api key");return t}static getInstance(){return void 0===Tt&&(Tt=new kt),Tt}}function Ot(){return At}var Dt;function Rt(){const t=Nt.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function jt(){switch(Nt.getInstance().document.visibilityState){case"visible":return Dt.VISIBLE;case"hidden":return Dt.HIDDEN;case"prerender":return Dt.PRERENDER;default:return Dt.UNKNOWN}}function Pt(){const t=Nt.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN",t[t.PRERENDER=3]="PRERENDER",t[t.UNLOADED=4]="UNLOADED"}(Dt||(Dt={}));const $t=new pt("Performance");$t.logLevel=ct.INFO;const Mt="0.0.1",Ct={loggingEnabled:!0},Lt="FIREBASE_INSTALLATIONS_AUTH";function Bt(t){const e=function(){const t=Nt.getInstance().localStorage,e=t.getItem(vt);if(!(e&&(n=e,Number(n)>Date.now())))return;var n;const r=t.getItem(wt);if(!r)return;try{const t=JSON.parse(r);return t}catch(t){return}}();return e?(Ft(e),Promise.resolve()):function(t){return function(){const t=kt.getInstance().firebaseAppInstance.installations().getToken();return t.then(t=>{}),t}().then(e=>{const n=kt.getInstance().getProjectId(),r=`https://firebaseremoteconfig.googleapis.com/v1/projects/${n}/namespaces/fireperf:fetch?key=${kt.getInstance().getApiKey()}`,i=new Request(r,{method:"POST",headers:{Authorization:`${Lt} ${e}`},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:kt.getInstance().getAppId(),app_version:ft,sdk_version:Mt})});return fetch(i).then(t=>{if(t.ok)return t.json();throw Et.create("RC response not ok")})}).catch(()=>{$t.info(qt)})}(t).then(t=>Ft(t)).then(t=>(function(t){if(!t)return;const e=Nt.getInstance().localStorage;e.setItem(wt,JSON.stringify(t)),e.setItem(vt,String(Date.now()+60*kt.getInstance().configTimeToLive*60*1e3))})(t),()=>{})}const qt="Could not fetch config, will use default configs";function Ft(t){if(!t)return t;const e=kt.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=Ct.loggingEnabled,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=Ut(e.tracesSamplingRate),e.logNetworkAfterSampling=Ut(e.networkRequestsSamplingRate),t}function Ut(t){return Math.random()<=t}let xt,Kt=1;function Vt(){return Kt=2,xt=xt||function(){const t=Nt.getInstance().document;return new Promise(e=>{if(t&&"complete"!==t.readyState){const n=()=>{"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()})}().then(()=>(function(){const t=kt.getInstance().firebaseAppInstance.installations().getId();return t.then(t=>{At=t}),t})()).then(t=>Bt(t)).then(()=>Ht(),()=>Ht())}function Ht(){Kt=3}const Wt=1e4,Jt=3;let zt,Gt=Jt,Qt=[];function Xt(t){return(e,n,...r)=>{!function(t){if(!t.eventTime||!t.message)throw Et.create("invalid cc log");Qt=[...Qt,t]}({message:t(...r),eventTime:Date.now()})}}function Yt(){if(zt)return zt;const t=Xt(ee);return(zt=new pt("@firebase/performance/cc")).logHandler=t,zt}function Zt(t){const e=kt.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&Nt.getInstance().requiredApisAvailable()&&(t.isAuto&&jt()!==Dt.VISIBLE||e.loggingEnabled&&e.logTraceAfterSampling&&(3===Kt?te(t):Vt().then(()=>te(t),()=>te(t))))}function te(t){Ot()&&setTimeout(()=>Yt().log(t,1),0)}function ee(t,e){return 0===e?function(t){const e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:ne(),network_request_metric:e};return JSON.stringify(n)}(t):function(t){const e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=re(t.counters));const n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=re(n));const r={application_info:ne(),trace_metric:e};return JSON.stringify(r)}(t)}function ne(){return{google_app_id:kt.getInstance().getAppId(),app_instance_id:Ot(),web_app_info:{sdk_version:ft,page_url:Nt.getInstance().getUrl(),service_worker_status:Rt(),visibility_state:jt(),effective_connection_type:Pt()},application_process_state:0}}function re(t){return Object.keys(t).map(e=>({key:e,value:t[e]}))}!function t(e){setTimeout(()=>{if(0===Gt)return;if(!Qt.length)return t(Wt);const e=[...Qt];Qt=[];const n=e.map(t=>({source_extension_json:t.message,event_time_ms:String(t.eventTime)})),r={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:kt.getInstance().logSource,log_event:n};fetch(kt.getInstance().logEndPointUrl,{method:"POST",body:JSON.stringify(r)}).then(t=>(t.ok||$t.info("Call to Firebase backend failed."),t.json())).then(e=>{const n=Number(e.next_request_wait_millis),r=isNaN(n)?Wt:Math.max(Wt,n);Gt=Jt,t(r)}).catch(()=>{Qt=[...e,...Qt],Gt--,$t.info(`Tries left: ${Gt}.`),t(Wt)})},e)}(5500);class ie{constructor(t,e=!1,n){this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=Nt.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`${dt}-${this.randomId}-${this.name}`,this.traceStopMark=`${ht}-${this.randomId}-${this.name}`,this.traceMeasure=n||`${gt}-${this.randomId}-${this.name}`,n&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw Et.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw Et.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Zt(this)}record(t,e,n){if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=Object.assign({},n.attributes)),n&&n.metrics)for(const t of Object.keys(n.metrics))isNaN(Number(n.metrics[t]))||(this.counters[t]=Number(Math.floor(n.metrics[t])));Zt(this)}incrementMetric(t,e=1){void 0===this.counters[t]&&(this.counters[t]=0),this.counters[t]+=e}putMetric(t,e){this.counters[t]=e}getMetric(t){return this.counters[t]||0}putAttribute(t,e){this.customAttributes[t]=e}getAttribute(t){return this.customAttributes[t]}removeAttribute(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(t){this.startTimeUs=t}setDuration(t){this.durationUs=t}calculateTraceMetrics(){const t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))}static createOobTrace(t,e,n){const r=Nt.getInstance().getUrl();if(!r)return;const i=new ie(mt+r,!0),o=Math.floor(1e3*Nt.getInstance().getTimeOrigin());i.setStartTime(o),t&&t[0]&&(i.setDuration(Math.floor(1e3*t[0].duration)),i.incrementMetric("domInteractive",Math.floor(1e3*t[0].domInteractive)),i.incrementMetric("domContentLoadedEventEnd",Math.floor(1e3*t[0].domContentLoadedEventEnd)),i.incrementMetric("loadEventEnd",Math.floor(1e3*t[0].loadEventEnd)));if(e){const t=e.find(t=>"first-paint"===t.name);t&&t.startTime&&i.incrementMetric(bt,Math.floor(1e3*t.startTime));const r=e.find(t=>"first-contentful-paint"===t.name);r&&r.startTime&&i.incrementMetric(_t,Math.floor(1e3*r.startTime)),n&&i.incrementMetric(yt,Math.floor(1e3*n))}Zt(i)}static createUserTimingTrace(t){Zt(new ie(t,!1,t))}}function oe(t){const e=t;if(!e||void 0===e.responseStart)return;const n=Nt.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){const e=kt.getInstance();e.instrumentationEnabled&&t.url!==e.logEndPointUrl.split("?")[0]&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout(()=>Yt().log(t,0),0)}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}const ae=5e3;function se(){Ot()&&(setTimeout(()=>(function(){const t=Nt.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){let r=setTimeout(()=>{ie.createOobTrace(e,n),r=void 0},ae);t.onFirstInputDelay(t=>{r&&(clearTimeout(r),ie.createOobTrace(e,n,t))})}else ie.createOobTrace(e,n)})(),0),setTimeout(()=>(function(){const t=Nt.getInstance(),e=t.getEntriesByType("resource");for(const t of e)oe(t);t.setupObserver("resource",oe)})(),0),setTimeout(()=>(function(){const t=Nt.getInstance(),e=t.getEntriesByType("measure");for(const t of e)ce(t);t.setupObserver("measure",ce)})(),0))}function ce(t){const e=t.name;e.substring(0,gt.length)!==gt&&ie.createUserTimingTrace(e)}class ue{constructor(t){this.app=t,Nt.getInstance().requiredApisAvailable()?Vt().then(se,se):$t.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled.")}trace(t){return new ie(t)}set instrumentationEnabled(t){kt.getInstance().instrumentationEnabled=t}get instrumentationEnabled(){return kt.getInstance().instrumentationEnabled}set dataCollectionEnabled(t){kt.getInstance().dataCollectionEnabled=t}get dataCollectionEnabled(){return kt.getInstance().dataCollectionEnabled}}const le="[DEFAULT]";return function(t){t.INTERNAL.registerService("performance",t=>{if(t.name!==le)throw Et.create("FB not default");if("undefined"==typeof window)throw Et.create("no window");return function(t){St=t}(window),kt.getInstance().firebaseAppInstance=t,new ue(t)},{})}(l),l});
//# sourceMappingURL=firebase-performance-standalone.es2017.js.map
